(function(){"use strict";var e={377:function(e,t,o){var r=o(5130),a=(o(8077),o(6768));function s(e,t,o,r,s,l){const n=(0,a.g2)("StartPage");return(0,a.uX)(),(0,a.Wv)(n)}var l=o(4232);const n=e=>((0,a.Qi)("data-v-184aa5e0"),e=e(),(0,a.jt)(),e),c={class:"header"},i={key:0},u={key:1},d={class:"filter-zone"},f={key:0,class:"node-card"},p={key:2,class:"centered-div"},h=n((()=>(0,a.Lk)("div",{class:"alert alert-success",role:"alert"}," Enter a path to the package: ",-1))),v=n((()=>(0,a.Lk)("div",{class:"alert alert-success",role:"alert"}," Loading data ",-1))),g=[v],k={key:0,class:"tooltip-wrapper"},m={class:"graph-zone"},b=["font-size"],w=n((()=>(0,a.Lk)("br",null,null,-1))),y=n((()=>(0,a.Lk)("br",null,null,-1)));function L(e,t,o,s,n,v){const L=(0,a.g2)("ErrorNotification"),R=(0,a.g2)("FilterBar"),x=(0,a.g2)("NodeCard"),C=(0,a.g2)("VNetworkGraph");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(L,{"error-message":e.errorMessage},null,8,["error-message"]),(0,a.Lk)("div",c,[e.isInputsVisible?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",null,[(0,a.Lk)("h5",null,[(0,a.eW)(" Dependency graph for: "+(0,l.v_)(e.path)+" ",1),(0,a.Lk)("button",{type:"button",class:"btn btn-danger control-btn",onClick:t[0]||(t[0]=(...t)=>e.reset&&e.reset(...t))},"Reset")])])])),e.isGraphVisible?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",d,[(0,a.bF)(R,{filter:e.filter,onFilterChanged:e.onFilterChanged},null,8,["filter","onFilterChanged"])]),e.selectedNode?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.bF)(x,{focusFilter:e.focusFilter,selectedNode:e.selectedNode,onFocusRequest:e.onFilterChanged},null,8,["focusFilter","selectedNode","onFocusRequest"])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),e.isInputsVisible?((0,a.uX)(),(0,a.CE)("div",p,[h,(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.path=t),type:"text",class:"form-control",placeholder:"Your path here","aria-label":"Path"},null,512),[[r.Jo,e.path]]),(0,a.Lk)("button",{type:"button",class:"btn btn-primary show-btn",onClick:t[2]||(t[2]=(...t)=>e.showGraph&&e.showGraph(...t))},"Show graph")])):(0,a.Q3)("",!0),(0,a.bF)(r.eB,null,{default:(0,a.k6)((()=>[e.isLoaderVisible?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,l.C4)(["centered-div loader",{"fade-enter":e.isLoaderVisible,"fade-leave-to":!e.isLoaderVisible}])},g,2)):(0,a.Q3)("",!0)])),_:1})]),e.isGraphVisible?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("div",m,[(0,a.bF)(C,{class:"graph",ref:"graph",layouts:e.layouts,"onUpdate:layouts":t[3]||(t[3]=t=>e.layouts=t),"selected-nodes":e.selectedNodes,"onUpdate:selectedNodes":t[4]||(t[4]=t=>e.selectedNodes=t),nodes:e.data.nodes,edges:e.data.edges,configs:e.configs,"event-handlers":e.eventHandlers},{"override-node-label":(0,a.k6)((({scale:e,text:t})=>[(0,a.Lk)("text",{x:"0",y:"0","font-size":14*e,"text-anchor":"middle","dominant-baseline":"central",fill:"#000000","font-family":"monospace"},(0,l.v_)(t),9,b)])),_:1},8,["layouts","selected-nodes","nodes","edges","configs","event-handlers"])]),(0,a.Lk)("div",{ref:"tooltip",class:"tooltip",style:(0,l.Tr)({...e.tooltipPos,opacity:e.tooltipOpacity})},[(0,a.Lk)("div",null,[(0,a.eW)((0,l.v_)(e.data.nodes[e.targetNodeId]?.name??"")+" ",1),w,(0,a.eW)(" FanIn: "+(0,l.v_)(e.data.nodes[e.targetNodeId]?.fanInCount??-1)+" ",1),y,(0,a.eW)(" FanOut: "+(0,l.v_)(e.data.nodes[e.targetNodeId]?.fanOutCount??-1),1)])],4),(0,a.Lk)("div",{ref:"edgetip",class:"edgetip",style:(0,l.Tr)({...e.edgetipPos,opacity:e.edgetipOpacity})},[(0,a.Lk)("div",null,(0,l.v_)(e.data.nodes[e.data.edges[e.targetEdgeId]?.source]?.name??" ??")+" -> "+(0,l.v_)(e.data.nodes[e.data.edges[e.targetEdgeId]?.target]?.name??" ??"),1)],4)])):(0,a.Q3)("",!0)],64)}var R=o(144),x=o(7266),C=o(8355);const F=e=>((0,a.Qi)("data-v-7e1fe430"),e=e(),(0,a.jt)(),e),O={class:"filter-container"},_={class:"form-check form-switch"},S=F((()=>(0,a.Lk)("label",{class:"form-check-label",for:"showStandard"},"Show standard",-1))),E={class:"form-check form-switch"},I=F((()=>(0,a.Lk)("label",{class:"form-check-label",for:"showPlatform"},"Show platform",-1))),K={class:"form-check form-switch"},N=F((()=>(0,a.Lk)("label",{class:"form-check-label",for:"showOuter"},"Show outer",-1))),P={class:"form-check form-switch"},V=F((()=>(0,a.Lk)("label",{class:"form-check-label",for:"showRatio"},"Show ratio",-1)));function j(e,t,o,s,l,n){return(0,a.uX)(),(0,a.CE)("div",O,[(0,a.Lk)("form",null,[(0,a.Lk)("div",_,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>n.filterLocal.showStandard=e),id:"showStandard"},null,512),[[r.lH,n.filterLocal.showStandard]]),S]),(0,a.Lk)("div",E,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>n.filterLocal.showPlatform=e),id:"showPlatform"},null,512),[[r.lH,n.filterLocal.showPlatform]]),I]),(0,a.Lk)("div",K,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>n.filterLocal.showOuter=e),id:"showOuter"},null,512),[[r.lH,n.filterLocal.showOuter]]),N]),(0,a.Lk)("div",P,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>n.filterLocal.showRatio=e),id:"showRatio"},null,512),[[r.lH,n.filterLocal.showRatio]]),V])])])}var z={name:"FilterBar",props:["filter"],computed:{filterLocal:{get:function(){return this.filter}}},created(){this.$watch("filterLocal",(e=>{this.$emit("filter-changed",e)}),{deep:!0})}},H=o(1241);const M=(0,H.A)(z,[["render",j],["__scopeId","data-v-7e1fe430"]]);var Q=M;const T=e=>((0,a.Qi)("data-v-795db1b9"),e=e(),(0,a.jt)(),e),U={key:0},X={class:"header"},q={class:"filter-container"},G={class:"form-check form-switch"},W=T((()=>(0,a.Lk)("label",{class:"form-check-label",for:"focusIns"},"Show ins",-1))),A={class:"form-check form-switch"},B=T((()=>(0,a.Lk)("label",{class:"form-check-label",for:"focusOuts"},"Show outs",-1)));function D(e,t,o,s,n,c){return o.selectedNode?((0,a.uX)(),(0,a.CE)("div",U,[(0,a.Lk)("div",X,(0,l.v_)(o.selectedNode.name),1),(0,a.Lk)("div",q,[(0,a.Lk)("form",null,[(0,a.Lk)("div",null,[(0,a.Lk)("div",G,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>c.filterLocal.focusIns=e),id:"focusIns",required:""},null,512),[[r.lH,c.filterLocal.focusIns]]),W]),(0,a.Lk)("div",A,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>c.filterLocal.focusOuts=e),id:"focusOuts",required:""},null,512),[[r.lH,c.filterLocal.focusOuts]]),B])]),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=e=>c.fireFocusRequest(c.filterLocal,!0))},"Focus"),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=e=>c.fireFocusRequest(c.filterLocal,!1))},"Reset focus")])])])):(0,a.Q3)("",!0)}var $={name:"NodeCard",props:["focusFilter","selectedNode"],computed:{filterLocal:{get:function(){return this.focusFilter}}},methods:{fireFocusRequest(e,t){e.doFocus=t,this.$emit("focus-request",e)}}};const J=(0,H.A)($,[["render",D],["__scopeId","data-v-795db1b9"]]);var Y=J;const Z={key:0},ee={class:"error-notification alert alert-danger"};function te(e,t,o,r,s,n){return e.showMessage?((0,a.uX)(),(0,a.CE)("div",Z,[(0,a.Lk)("div",ee,[(0,a.Lk)("button",{class:"btn btn-close top-right",onClick:t[0]||(t[0]=(...t)=>e.closeError&&e.closeError(...t))}),(0,a.Lk)("p",null,(0,l.v_)(e.$props.errorMessage),1)])])):(0,a.Q3)("",!0)}var oe={name:"ErrorNotification",props:{errorMessage:{required:!0}},watch:{errorMessage(e){e.length>0&&this.showError()}},setup:function(){const e=(0,R.KR)(!1),t=function(){e.value=!1},o=(0,R.KR)(5e3),r=function(){e.value=!0,setTimeout((()=>{t()}),o.value)};return{showMessage:e,closeError:t,showError:r,timeout:o}}};const re=(0,H.A)(oe,[["render",te],["__scopeId","data-v-0573c0fc"]]);var ae=re,se={name:"StartPage",components:{FilterBar:Q,VNetworkGraph:x.zS,NodeCard:Y,ErrorNotification:ae},mounted(){this.showGraph()},setup:function(){const e=(0,R.KR)("/Users/ilyaromanov/Projects/platform-go/"),t=(0,R.KR)(!0),o=(0,R.KR)(!1),r=(0,R.KR)(!1),s=(0,R.KR)([]),l=(0,R.KR)(),n=(0,R.KR)(""),c=(0,R.Kh)({nodes:{},edges:{}}),i=(0,R.KR)({}),u=()=>{t.value=!1,o.value=!0,p()},d=()=>{o.value=!1,r.value=!1,t.value=!0},f=function(){u()},p=async()=>{try{let t=0;T.focusIns&&T.focusOuts?t=2:T.focusIns&&(t=1);let o="";T.doFocus&&(o=l.value?.id??"");const a=await C.A.get("/api/graph",{params:{path:encodeURIComponent(e.value),show_standard:Q.showStandard,show_platform:Q.showPlatform,show_outer:Q.showOuter,focus_package:o,focus_type:t,show_ratio:Q.showRatio}});c.nodes=a.data.nodes,c.edges=a.data.edges,r.value=!0}catch(t){h("Cannot fetch graph: "+t.message)}o.value=!1},h=function(e){const t=(new Date).toLocaleTimeString("ru-ru",{hour12:!1});n.value=t+" "+e},v=20,g=v/2,k=8,m=25,b=10,w=function(e){let t=(e.name.length-1)*k+m;return Q.showRatio||(t+=(e.fanInCount.toString().length+e.fanOutCount.toString().length+2)*k),Math.ceil(t/b)*b},y=x.xq({view:{layoutHandler:new x.JT({grid:b})},node:{selectable:!0,normal:{radius:e=>e.size??g,color:e=>e.color,type:"rect",width:e=>w(e)},hover:{color:e=>e.color},label:{color:"#000000",fontSize:14}},edge:{type:"curve",normal:{color:e=>e.color,width:2},hover:{color:e=>e.color},margin:4,marker:{target:{type:"arrow",width:4,height:4}}}}),L=(0,R.KR)(),F=(0,R.KR)(),O=(0,R.KR)(""),_=(0,R.KR)(0),S=(0,R.KR)({left:"0px",top:"0px"}),E=(0,R.KR)(),I=(0,R.KR)(0),K=(0,R.KR)({left:"0px",top:"0px"}),N=2,P=(0,R.KR)(""),V=(0,a.EW)((()=>{if(!O.value)return{x:0,y:0};const e=i.value.nodes[O.value];return e||{x:0,y:0}})),j=(0,a.EW)((()=>{const e=c.edges[P.value];if(!e)return{x:0,y:0};const t=c.edges[P.value].source,o=c.edges[P.value].target;return{x:(i.value.nodes[t].x+i.value.nodes[o].x)/2,y:(i.value.nodes[t].y+i.value.nodes[o].y)/2}}));(0,a.wB)((()=>[V.value,_.value]),(()=>{if(!L.value||!F.value)return;const e=L.value.translateFromSvgToDomCoordinates(V.value);S.value={left:e.x-F.value.offsetWidth/2+"px",top:e.y-g-F.value.offsetHeight-10+"px"}}),{deep:!0}),(0,a.wB)((()=>[j.value,I.value]),(()=>{if(!L.value||!E.value)return{x:0,y:0};if(!P.value)return{x:0,y:0};const e=L.value.translateFromSvgToDomCoordinates(j.value);K.value={left:e.x-E.value.offsetWidth/2+"px",top:e.y-N-E.value.offsetHeight-10+"px"}}),{deep:!0}),(0,a.wB)((()=>[s.value]),(()=>{0===s.value.length?l.value=null:l.value=c.nodes[s.value[0]]}),{deep:!0});const z=(0,R.KR)(""),H=(0,R.KR)(""),M={"node:pointerover":({node:e})=>{O.value=e,_.value=1},"node:pointerout":({node:e})=>{O.value=e,_.value=0},"edge:pointerover":({edge:e})=>{P.value=e??"";const t=c.edges[e];z.value=c.nodes[t.source].color,c.nodes[t.source].color="red",c.nodes[t.source].size=2*g,H.value=c.nodes[t.target].color,c.nodes[t.target].color="red",c.nodes[t.target].size=2*g,I.value=1},"edge:pointerout":({edge:e})=>{P.value=e??"",I.value=0;const t=c.edges[e];c.nodes[t.source].color=z.value,delete c.nodes[t.source].size,c.nodes[t.target].color=H.value,delete c.nodes[t.target].size}},Q=(0,R.Kh)({showStandard:!1,showPlatform:!0,showOuter:!0,showRatio:!1}),T=(0,R.Kh)({focusIns:!0,focusOuts:!0,doFocus:!1});return{path:e,isInputsVisible:t,isLoaderVisible:o,isGraphVisible:r,showGraph:u,reset:d,data:c,layouts:i,configs:y,eventHandlers:M,tooltipPos:S,tooltipOpacity:_,targetNodeId:O,graph:L,tooltip:F,edgetip:E,targetEdgeId:P,edgetipPos:K,edgetipOpacity:I,edgeCenterPos:j,filter:Q,onFilterChanged:f,selectedNodes:s,selectedNode:l,focusFilter:T,errorMessage:n}}};const le=(0,H.A)(se,[["render",L],["__scopeId","data-v-184aa5e0"]]);var ne=le,ce={name:"App",components:{StartPage:ne}};const ie=(0,H.A)(ce,[["render",s]]);var ue=ie;(0,r.Ef)(ue).mount("#app")}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,r,a,s){if(!r){var l=1/0;for(u=0;u<e.length;u++){r=e[u][0],a=e[u][1],s=e[u][2];for(var n=!0,c=0;c<r.length;c++)(!1&s||l>=s)&&Object.keys(o.O).every((function(e){return o.O[e](r[c])}))?r.splice(c--,1):(n=!1,s<l&&(l=s));if(n){e.splice(u--,1);var i=a();void 0!==i&&(t=i)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[r,a,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,s,l=r[0],n=r[1],c=r[2],i=0;if(l.some((function(t){return 0!==e[t]}))){for(a in n)o.o(n,a)&&(o.m[a]=n[a]);if(c)var u=c(o)}for(t&&t(r);i<l.length;i++)s=l[i],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(u)},r=self["webpackChunkvue_app"]=self["webpackChunkvue_app"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(377)}));r=o.O(r)})();
//# sourceMappingURL=app.69e619b5.js.map